#include "pe.h"


char shellcode[] = {
	0x55, 0x8b, 0xec, 0x6a, 0xff, 0x68, 0xa0, 0x67, 0x41, 0x00, 0x64, 0xa1, 0x00, 0x00, 0x00, 0x00, 0x50, 0x64, 0x89, 0x25, 0x00, 0x00, 0x00, 0x00, 0x51, 0x81, 0xec, 0x70, 0x06, 0x00, 0x00, 0x53, 0x56, 0x57, 0x89, 0x65, 0xf0, 0xc7, 0x45, 0xec, 0x01, 0x00, 0x00, 0x00, 0xc7, 0x45,
	0xe8, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xe4, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x50, 0x64, 0xa1, 0x30, 0x00, 0x00, 0x00, 0x8b, 0x40, 0x0c, 0x8b, 0x40, 0x0c, 0x8b, 0x00, 0x8b, 0x00, 0x8b, 0x40, 0x18,
	0x89, 0x45, 0xe0, 0x58, 0xc6, 0x45, 0xd0, 0x47, 0xc6, 0x45, 0xd1, 0x65, 0xc6, 0x45, 0xd2, 0x74, 0xc6, 0x45, 0xd3, 0x50, 0xc6, 0x45, 0xd4, 0x72, 0xc6, 0x45, 0xd5, 0x6f, 0xc6, 0x45, 0xd6, 0x63, 0xc6, 0x45, 0xd7, 0x41, 0xc6, 0x45, 0xd8, 0x64, 0xc6, 0x45, 0xd9, 0x64, 0xc6, 0x45,
	0xda, 0x72, 0xc6, 0x45, 0xdb, 0x65, 0xc6, 0x45, 0xdc, 0x73, 0xc6, 0x45, 0xdd, 0x73, 0xc6, 0x45, 0xde, 0x00, 0xc7, 0x45, 0xcc, 0x00, 0x00, 0x00, 0x00, 0x8b, 0x45, 0xe0, 0x89, 0x45, 0xc8, 0x8b, 0x45, 0xc8, 0x8b, 0x4d, 0xe0, 0x03, 0x48, 0x3c, 0x89, 0x4d, 0xc4, 0xb8, 0x08, 0x00,
	0x00, 0x00, 0x6b, 0xc8, 0x00, 0x8b, 0x55, 0xc4, 0x8b, 0x45, 0xe0, 0x03, 0x44, 0x0a, 0x78, 0x89, 0x45, 0xc0, 0x8b, 0x45, 0xc0, 0x8b, 0x4d, 0xe0, 0x03, 0x48, 0x24, 0x89, 0x4d, 0xbc, 0x8b, 0x45, 0xc0, 0x8b, 0x4d, 0xe0, 0x03, 0x48, 0x20, 0x89, 0x4d, 0xb8, 0x8b, 0x45, 0xc0, 0x8b,
	0x4d, 0xe0, 0x03, 0x48, 0x1c, 0x89, 0x4d, 0xb4, 0xc7, 0x45, 0xb0, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x09, 0x8b, 0x45, 0xb0, 0x83, 0xc0, 0x01, 0x89, 0x45, 0xb0, 0x8b, 0x45, 0xc0, 0x8b, 0x4d, 0xb0, 0x3b, 0x48, 0x18, 0x0f, 0x83, 0x82, 0x00, 0x00, 0x00, 0x8b, 0x45, 0xb0, 0x8b, 0x4d,
	0xb8, 0x8b, 0x55, 0xe0, 0x03, 0x14, 0x81, 0x89, 0x55, 0xac, 0x8b, 0x45, 0xac, 0x89, 0x45, 0xa8, 0x8d, 0x45, 0xd0, 0x89, 0x45, 0xa4, 0xc6, 0x45, 0xa3, 0x01, 0x8b, 0x45, 0xa8, 0x0f, 0xbe, 0x08, 0x85, 0xc9, 0x75, 0x0a, 0x8b, 0x45, 0xa4, 0x0f, 0xbe, 0x08, 0x85, 0xc9, 0x74, 0x2a,
	0x8b, 0x45, 0xa4, 0x0f, 0xbe, 0x08, 0x8b, 0x55, 0xa8, 0x0f, 0xbe, 0x02, 0x3b, 0xc1, 0x74, 0x06, 0xc6, 0x45, 0xa3, 0x00, 0xeb, 0x14, 0x8b, 0x45, 0xa8, 0x83, 0xc0, 0x01, 0x89, 0x45, 0xa8, 0x8b, 0x45, 0xa4, 0x83, 0xc0, 0x01, 0x89, 0x45, 0xa4, 0xeb, 0xc2, 0x0f, 0xb6, 0x45, 0xa3,
	0x85, 0xc0, 0x74, 0x18, 0x8b, 0x45, 0xb0, 0x8b, 0x4d, 0xbc, 0x0f, 0xbf, 0x14, 0x41, 0x8b, 0x45, 0xb4, 0x8b, 0x4d, 0xe0, 0x03, 0x0c, 0x90, 0x89, 0x4d, 0xcc, 0xeb, 0x05, 0xe9, 0x66, 0xff, 0xff, 0xff, 0xc7, 0x45, 0xc8, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x45, 0xc4, 0x00, 0x00, 0x00,
	0x00, 0xc6, 0x45, 0x90, 0x4c, 0xc6, 0x45, 0x91, 0x6f, 0xc6, 0x45, 0x92, 0x61, 0xc6, 0x45, 0x93, 0x64, 0xc6, 0x45, 0x94, 0x4c, 0xc6, 0x45, 0x95, 0x69, 0xc6, 0x45, 0x96, 0x62, 0xc6, 0x45, 0x97, 0x72, 0xc6, 0x45, 0x98, 0x61, 0xc6, 0x45, 0x99, 0x72, 0xc6, 0x45, 0x9a, 0x79, 0xc6,
	0x45, 0x9b, 0x41, 0xc6, 0x45, 0x9c, 0x00, 0xc6, 0x85, 0x7c, 0xff, 0xff, 0xff, 0x47, 0xc6, 0x85, 0x7d, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x7e, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x7f, 0xff, 0xff, 0xff, 0x4d, 0xc6, 0x45, 0x80, 0x6f, 0xc6, 0x45, 0x81, 0x64, 0xc6, 0x45, 0x82,
	0x75, 0xc6, 0x45, 0x83, 0x6c, 0xc6, 0x45, 0x84, 0x65, 0xc6, 0x45, 0x85, 0x48, 0xc6, 0x45, 0x86, 0x61, 0xc6, 0x45, 0x87, 0x6e, 0xc6, 0x45, 0x88, 0x64, 0xc6, 0x45, 0x89, 0x6c, 0xc6, 0x45, 0x8a, 0x65, 0xc6, 0x45, 0x8b, 0x41, 0xc6, 0x45, 0x8c, 0x00, 0xc6, 0x85, 0x6c, 0xff, 0xff,
	0xff, 0x43, 0xc6, 0x85, 0x6d, 0xff, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x6e, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x6f, 0xff, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x70, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x71, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x72, 0xff, 0xff, 0xff, 0x50, 0xc6, 0x85,
	0x73, 0xff, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x74, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x75, 0xff, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x76, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x77, 0xff, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x78, 0xff, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x79, 0xff, 0xff, 0xff,
	0x41, 0xc6, 0x85, 0x7a, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x58, 0xff, 0xff, 0xff, 0x47, 0xc6, 0x85, 0x59, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x5a, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x5b, 0xff, 0xff, 0xff, 0x4d, 0xc6, 0x85, 0x5c, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x5d,
	0xff, 0xff, 0xff, 0x64, 0xc6, 0x85, 0x5e, 0xff, 0xff, 0xff, 0x75, 0xc6, 0x85, 0x5f, 0xff, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0x60, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x61, 0xff, 0xff, 0xff, 0x46, 0xc6, 0x85, 0x62, 0xff, 0xff, 0xff, 0x69, 0xc6, 0x85, 0x63, 0xff, 0xff, 0xff, 0x6c,
	0xc6, 0x85, 0x64, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x65, 0xff, 0xff, 0xff, 0x4e, 0xc6, 0x85, 0x66, 0xff, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x67, 0xff, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x68, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x69, 0xff, 0xff, 0xff, 0x41, 0xc6, 0x85, 0x6a, 0xff,
	0xff, 0xff, 0x00, 0xc6, 0x85, 0x44, 0xff, 0xff, 0xff, 0x47, 0xc6, 0x85, 0x45, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x46, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x47, 0xff, 0xff, 0xff, 0x54, 0xc6, 0x85, 0x48, 0xff, 0xff, 0xff, 0x68, 0xc6, 0x85, 0x49, 0xff, 0xff, 0xff, 0x72, 0xc6,
	0x85, 0x4a, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x4b, 0xff, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x4c, 0xff, 0xff, 0xff, 0x64, 0xc6, 0x85, 0x4d, 0xff, 0xff, 0xff, 0x43, 0xc6, 0x85, 0x4e, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x4f, 0xff, 0xff, 0xff, 0x6e, 0xc6, 0x85, 0x50, 0xff, 0xff,
	0xff, 0x74, 0xc6, 0x85, 0x51, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x52, 0xff, 0xff, 0xff, 0x78, 0xc6, 0x85, 0x53, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x54, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x30, 0xff, 0xff, 0xff, 0x52, 0xc6, 0x85, 0x31, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85,
	0x32, 0xff, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x33, 0xff, 0xff, 0xff, 0x64, 0xc6, 0x85, 0x34, 0xff, 0xff, 0xff, 0x50, 0xc6, 0x85, 0x35, 0xff, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x36, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x37, 0xff, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x38, 0xff, 0xff, 0xff,
	0x65, 0xc6, 0x85, 0x39, 0xff, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x3a, 0xff, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x3b, 0xff, 0xff, 0xff, 0x4d, 0xc6, 0x85, 0x3c, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x3d, 0xff, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x3e, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x3f,
	0xff, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x40, 0xff, 0xff, 0xff, 0x79, 0xc6, 0x85, 0x41, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x18, 0xff, 0xff, 0xff, 0x5a, 0xc6, 0x85, 0x19, 0xff, 0xff, 0xff, 0x77, 0xc6, 0x85, 0x1a, 0xff, 0xff, 0xff, 0x55, 0xc6, 0x85, 0x1b, 0xff, 0xff, 0xff, 0x6e,
	0xc6, 0x85, 0x1c, 0xff, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x1d, 0xff, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x1e, 0xff, 0xff, 0xff, 0x70, 0xc6, 0x85, 0x1f, 0xff, 0xff, 0xff, 0x56, 0xc6, 0x85, 0x20, 0xff, 0xff, 0xff, 0x69, 0xc6, 0x85, 0x21, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x22, 0xff,
	0xff, 0xff, 0x77, 0xc6, 0x85, 0x23, 0xff, 0xff, 0xff, 0x4f, 0xc6, 0x85, 0x24, 0xff, 0xff, 0xff, 0x66, 0xc6, 0x85, 0x25, 0xff, 0xff, 0xff, 0x53, 0xc6, 0x85, 0x26, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x27, 0xff, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x28, 0xff, 0xff, 0xff, 0x74, 0xc6,
	0x85, 0x29, 0xff, 0xff, 0xff, 0x69, 0xc6, 0x85, 0x2a, 0xff, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x2b, 0xff, 0xff, 0xff, 0x6e, 0xc6, 0x85, 0x2c, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x0c, 0xff, 0xff, 0xff, 0x6e, 0xc6, 0x85, 0x0d, 0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x0e, 0xff, 0xff,
	0xff, 0x64, 0xc6, 0x85, 0x0f, 0xff, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0x10, 0xff, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0x11, 0xff, 0xff, 0xff, 0x2e, 0xc6, 0x85, 0x12, 0xff, 0xff, 0xff, 0x64, 0xc6, 0x85, 0x13, 0xff, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0x14, 0xff, 0xff, 0xff, 0x6c, 0xc6, 0x85,
	0x15, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x04, 0xff, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x05, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x06, 0xff, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x07, 0xff, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x08, 0xff, 0xff, 0xff, 0x70, 0xc6, 0x85, 0x09, 0xff, 0xff, 0xff,
	0x79, 0xc6, 0x85, 0x0a, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0xfc, 0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0xfd, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xfe, 0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0xff, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x00, 0xff, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x01,
	0xff, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x02, 0xff, 0xff, 0xff, 0x00, 0xc6, 0x85, 0xf0, 0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0xf1, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0xf2, 0xfe, 0xff, 0xff, 0x76, 0xc6, 0x85, 0xf3, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0xf4, 0xfe, 0xff, 0xff, 0x72,
	0xc6, 0x85, 0xf5, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xf6, 0xfe, 0xff, 0xff, 0x2e, 0xc6, 0x85, 0xf7, 0xfe, 0xff, 0xff, 0x64, 0xc6, 0x85, 0xf8, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xf9, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xfa, 0xfe, 0xff, 0xff, 0x00, 0xc6, 0x85, 0xe8, 0xfe,
	0xff, 0xff, 0x6d, 0xc6, 0x85, 0xe9, 0xfe, 0xff, 0xff, 0x61, 0xc6, 0x85, 0xea, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xeb, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xec, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0xed, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0xee, 0xfe, 0xff, 0xff, 0x00, 0xc6,
	0x85, 0xe0, 0xfe, 0xff, 0xff, 0x66, 0xc6, 0x85, 0xe1, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xe2, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xe3, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xe4, 0xfe, 0xff, 0xff, 0x00, 0xc6, 0x85, 0xd0, 0xfe, 0xff, 0xff, 0x56, 0xc6, 0x85, 0xd1, 0xfe, 0xff,
	0xff, 0x69, 0xc6, 0x85, 0xd2, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xd3, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xd4, 0xfe, 0xff, 0xff, 0x75, 0xc6, 0x85, 0xd5, 0xfe, 0xff, 0xff, 0x61, 0xc6, 0x85, 0xd6, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xd7, 0xfe, 0xff, 0xff, 0x41, 0xc6, 0x85,
	0xd8, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xd9, 0xfe, 0xff, 0xff, 0x6c, 0xc6, 0x85, 0xda, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0xdb, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0xdc, 0xfe, 0xff, 0xff, 0x45, 0xc6, 0x85, 0xdd, 0xfe, 0xff, 0xff, 0x78, 0xc6, 0x85, 0xde, 0xfe, 0xff, 0xff,
	0x00, 0xc6, 0x85, 0xbc, 0xfe, 0xff, 0xff, 0x57, 0xc6, 0x85, 0xbd, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xbe, 0xfe, 0xff, 0xff, 0x69, 0xc6, 0x85, 0xbf, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xc0, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xc1, 0xfe, 0xff, 0xff, 0x50, 0xc6, 0x85, 0xc2,
	0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xc3, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0xc4, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0xc5, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xc6, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0xc7, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0xc8, 0xfe, 0xff, 0xff, 0x4d,
	0xc6, 0x85, 0xc9, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xca, 0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0xcb, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0xcc, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xcd, 0xfe, 0xff, 0xff, 0x79, 0xc6, 0x85, 0xce, 0xfe, 0xff, 0xff, 0x00, 0xc6, 0x85, 0xa8, 0xfe,
	0xff, 0xff, 0x53, 0xc6, 0x85, 0xa9, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0xaa, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xab, 0xfe, 0xff, 0xff, 0x54, 0xc6, 0x85, 0xac, 0xfe, 0xff, 0xff, 0x68, 0xc6, 0x85, 0xad, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xae, 0xfe, 0xff, 0xff, 0x65, 0xc6,
	0x85, 0xaf, 0xfe, 0xff, 0xff, 0x61, 0xc6, 0x85, 0xb0, 0xfe, 0xff, 0xff, 0x64, 0xc6, 0x85, 0xb1, 0xfe, 0xff, 0xff, 0x43, 0xc6, 0x85, 0xb2, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0xb3, 0xfe, 0xff, 0xff, 0x6e, 0xc6, 0x85, 0xb4, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xb5, 0xfe, 0xff,
	0xff, 0x65, 0xc6, 0x85, 0xb6, 0xfe, 0xff, 0xff, 0x78, 0xc6, 0x85, 0xb7, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0xb8, 0xfe, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x98, 0xfe, 0xff, 0xff, 0x52, 0xc6, 0x85, 0x99, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x9a, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85,
	0x9b, 0xfe, 0xff, 0xff, 0x75, 0xc6, 0x85, 0x9c, 0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x9d, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x9e, 0xfe, 0xff, 0xff, 0x54, 0xc6, 0x85, 0x9f, 0xfe, 0xff, 0xff, 0x68, 0xc6, 0x85, 0xa0, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0xa1, 0xfe, 0xff, 0xff,
	0x65, 0xc6, 0x85, 0xa2, 0xfe, 0xff, 0xff, 0x61, 0xc6, 0x85, 0xa3, 0xfe, 0xff, 0xff, 0x64, 0xc6, 0x85, 0xa4, 0xfe, 0xff, 0xff, 0x00, 0xc6, 0x85, 0x84, 0xfe, 0xff, 0xff, 0x54, 0xc6, 0x85, 0x85, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x86, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x87,
	0xfe, 0xff, 0xff, 0x6d, 0xc6, 0x85, 0x88, 0xfe, 0xff, 0xff, 0x69, 0xc6, 0x85, 0x89, 0xfe, 0xff, 0xff, 0x6e, 0xc6, 0x85, 0x8a, 0xfe, 0xff, 0xff, 0x61, 0xc6, 0x85, 0x8b, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x8c, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x8d, 0xfe, 0xff, 0xff, 0x50,
	0xc6, 0x85, 0x8e, 0xfe, 0xff, 0xff, 0x72, 0xc6, 0x85, 0x8f, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x90, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x91, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x92, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x93, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x94, 0xfe,
	0xff, 0xff, 0x00, 0xc6, 0x85, 0x78, 0xfe, 0xff, 0xff, 0x45, 0xc6, 0x85, 0x79, 0xfe, 0xff, 0xff, 0x78, 0xc6, 0x85, 0x7a, 0xfe, 0xff, 0xff, 0x69, 0xc6, 0x85, 0x7b, 0xfe, 0xff, 0xff, 0x74, 0xc6, 0x85, 0x7c, 0xfe, 0xff, 0xff, 0x50, 0xc6, 0x85, 0x7d, 0xfe, 0xff, 0xff, 0x72, 0xc6,
	0x85, 0x7e, 0xfe, 0xff, 0xff, 0x6f, 0xc6, 0x85, 0x7f, 0xfe, 0xff, 0xff, 0x63, 0xc6, 0x85, 0x80, 0xfe, 0xff, 0xff, 0x65, 0xc6, 0x85, 0x81, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x82, 0xfe, 0xff, 0xff, 0x73, 0xc6, 0x85, 0x83, 0xfe, 0xff, 0xff, 0x00, 0x8d, 0x45, 0x90, 0x50, 0x8b,
	0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x74, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x7c, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95,
	0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x70, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x6c, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x6c, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x58, 0xff,
	0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x68, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x44, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9,
	0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x64, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x30, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x60, 0xfe, 0xff, 0xff,
	0x8d, 0x85, 0xbc, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x5c, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0xd0, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc,
	0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x58, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0xa8, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95,
	0x54, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x98, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x50, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x84, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0,
	0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x55, 0xe4, 0x8d, 0x85, 0x78, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x4d, 0xe0, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89,
	0x95, 0x4c, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x0c, 0xff, 0xff, 0xff, 0x50, 0xff, 0x95, 0x70, 0xfe, 0xff, 0xff, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x8d, 0x48, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x18, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x48,
	0xfe, 0xff, 0xff, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x44, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0x04, 0xff, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x48, 0xfe, 0xff, 0xff, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9,
	0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x40, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0xfc, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x48, 0xfe, 0xff, 0xff, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x3c,
	0xfe, 0xff, 0xff, 0x8d, 0x85, 0xf0, 0xfe, 0xff, 0xff, 0x50, 0xff, 0x95, 0x74, 0xfe, 0xff, 0xff, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x8d, 0x38, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0xe8, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x38, 0xfe, 0xff,
	0xff, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x34, 0xfe, 0xff, 0xff, 0x8d, 0x85, 0xe0, 0xfe, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x38, 0xfe, 0xff, 0xff, 0x51, 0xff, 0x55, 0xcc, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff,
	0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x30, 0xfe, 0xff, 0xff, 0x6a, 0x00, 0xff, 0x95, 0x70, 0xfe, 0xff, 0xff, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x85, 0x2c, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x2c, 0xfe, 0xff, 0xff, 0x89, 0x45,
	0xc8, 0x8b, 0x45, 0xc8, 0x8b, 0x8d, 0x2c, 0xfe, 0xff, 0xff, 0x03, 0x48, 0x3c, 0x89, 0x4d, 0xc4, 0x8b, 0x45, 0xc4, 0x0f, 0xb7, 0x48, 0x14, 0x8b, 0x55, 0xc4, 0x8d, 0x44, 0x0a, 0x18, 0x89, 0x85, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x45, 0xc4, 0x0f, 0xb7, 0x48, 0x06, 0x6b, 0xd1, 0x28,
	0x8b, 0x85, 0x28, 0xfe, 0xff, 0xff, 0x8d, 0x4c, 0x10, 0xd8, 0x89, 0x8d, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x0c, 0x8b, 0x95, 0x2c, 0xfe, 0xff, 0xff, 0x8d, 0x84, 0x0a, 0x00, 0x20, 0x00, 0x00, 0x89, 0x85, 0x24, 0xfe, 0xff, 0xff, 0x8b, 0x85,
	0x28, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x10, 0x81, 0xe9, 0x00, 0x20, 0x00, 0x00, 0x89, 0x8d, 0x20, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x24, 0xfe, 0xff, 0xff, 0x89, 0x45, 0xc8, 0x8b, 0x45, 0xc8, 0x8b, 0x8d, 0x24, 0xfe, 0xff, 0xff, 0x03, 0x48, 0x3c, 0x89, 0x4d, 0xc4, 0x8b, 0x45, 0xc4,
	0x83, 0xc0, 0x18, 0x89, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x45, 0xc4, 0x0f, 0xb7, 0x48, 0x14, 0x03, 0x8d, 0x1c, 0xfe, 0xff, 0xff, 0x89, 0x8d, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x45, 0xc4, 0x0f, 0xb7, 0x48, 0x06, 0x83, 0xe9, 0x01, 0x6b, 0xd1, 0x28, 0x8b, 0x45, 0xc4, 0x0f, 0xb7,
	0x48, 0x06, 0x83, 0xe9, 0x01, 0x6b, 0xc1, 0x28, 0x8b, 0x8d, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x44, 0x01, 0x0c, 0x8b, 0x8d, 0x28, 0xfe, 0xff, 0xff, 0x03, 0x44, 0x11, 0x10, 0x89, 0x85, 0x18, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x8d, 0x18, 0xfe, 0xff, 0xff,
	0x3b, 0x48, 0x38, 0x76, 0x0e, 0x8b, 0x95, 0x18, 0xfe, 0xff, 0xff, 0x89, 0x95, 0x80, 0xf9, 0xff, 0xff, 0xeb, 0x0f, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x38, 0x89, 0x8d, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0x18, 0xfe, 0xff, 0xff,
	0x8b, 0x85, 0x18, 0xfe, 0xff, 0xff, 0x50, 0xff, 0x95, 0x34, 0xfe, 0xff, 0xff, 0x83, 0xc4, 0x04, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x8d, 0x14, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x18, 0xfe, 0xff, 0xff, 0x50, 0x6a, 0x00, 0x8b, 0x8d, 0x14,
	0xfe, 0xff, 0xff, 0x51, 0xff, 0x95, 0x3c, 0xfe, 0xff, 0xff, 0x83, 0xc4, 0x0c, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x3c, 0x51, 0x8b, 0x95, 0x24, 0xfe, 0xff, 0xff, 0x52, 0x8b, 0x85, 0x14, 0xfe, 0xff, 0xff, 0x50, 0xff, 0x95, 0x40, 0xfe, 0xff, 0xff, 0x83, 0xc4, 0x0c,
	0xc7, 0x85, 0x10, 0xfe, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x0f, 0x8b, 0x85, 0x10, 0xfe, 0xff, 0xff, 0x83, 0xc0, 0x01, 0x89, 0x85, 0x10, 0xfe, 0xff, 0xff, 0x8b, 0x45, 0xc4, 0x0f, 0xb7, 0x48, 0x06, 0x39, 0x8d, 0x10, 0xfe, 0xff, 0xff, 0x7d, 0x44, 0x8b, 0x85, 0x28, 0xfe,
	0xff, 0xff, 0x8b, 0x48, 0x10, 0x51, 0x8b, 0x95, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x24, 0xfe, 0xff, 0xff, 0x03, 0x42, 0x14, 0x50, 0x8b, 0x8d, 0x28, 0xfe, 0xff, 0xff, 0x8b, 0x95, 0x14, 0xfe, 0xff, 0xff, 0x03, 0x51, 0x0c, 0x52, 0xff, 0x95, 0x40, 0xfe, 0xff, 0xff, 0x83, 0xc4,
	0x0c, 0x8b, 0x85, 0x28, 0xfe, 0xff, 0xff, 0x83, 0xc0, 0x28, 0x89, 0x85, 0x28, 0xfe, 0xff, 0xff, 0xeb, 0x9e, 0x68, 0x04, 0x01, 0x00, 0x00, 0x8d, 0x85, 0x0c, 0xfd, 0xff, 0xff, 0x50, 0x6a, 0x00, 0xff, 0x95, 0x68, 0xfe, 0xff, 0xff, 0x6a, 0x44, 0x6a, 0x00, 0x8d, 0x85, 0xc8, 0xfc,
	0xff, 0xff, 0x50, 0xff, 0x95, 0x3c, 0xfe, 0xff, 0xff, 0x83, 0xc4, 0x0c, 0x6a, 0x10, 0x6a, 0x00, 0x8d, 0x85, 0xb8, 0xfc, 0xff, 0xff, 0x50, 0xff, 0x95, 0x3c, 0xfe, 0xff, 0xff, 0x83, 0xc4, 0x0c, 0xc7, 0x85, 0xc8, 0xfc, 0xff, 0xff, 0x44, 0x00, 0x00, 0x00, 0x8d, 0x85, 0xb8, 0xfc,
	0xff, 0xff, 0x50, 0x8d, 0x8d, 0xc8, 0xfc, 0xff, 0xff, 0x51, 0x6a, 0x00, 0x6a, 0x00, 0x6a, 0x04, 0x6a, 0x00, 0x6a, 0x00, 0x6a, 0x00, 0x8d, 0x95, 0x0c, 0xfd, 0xff, 0xff, 0x52, 0x6a, 0x00, 0xff, 0x95, 0x6c, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0xb8, 0xfc, 0xff, 0xff, 0x89, 0x45, 0xe8,
	0xc7, 0x85, 0xec, 0xf9, 0xff, 0xff, 0x07, 0x00, 0x01, 0x00, 0x8d, 0x85, 0xec, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0xbc, 0xfc, 0xff, 0xff, 0x51, 0xff, 0x95, 0x64, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x9c, 0xfa, 0xff, 0xff, 0x89, 0x85, 0xe8, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0x90, 0xfa,
	0xff, 0xff, 0x83, 0xc0, 0x08, 0x89, 0x85, 0xe4, 0xf9, 0xff, 0xff, 0xc7, 0x85, 0xe0, 0xf9, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x6a, 0x00, 0x6a, 0x04, 0x8d, 0x85, 0xe0, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0xe4, 0xf9, 0xff, 0xff, 0x51, 0x8b, 0x95, 0xb8, 0xfc, 0xff, 0xff, 0x52,
	0xff, 0x95, 0x60, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0xe0, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0xb8, 0xfc, 0xff, 0xff, 0x51, 0xff, 0x95, 0x44, 0xfe, 0xff, 0xff, 0x6a, 0x40, 0x68, 0x00, 0x30, 0x00, 0x00, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x38, 0x51, 0x8b, 0x95, 0x1c,
	0xfe, 0xff, 0xff, 0x8b, 0x42, 0x1c, 0x50, 0x8b, 0x8d, 0xb8, 0xfc, 0xff, 0xff, 0x51, 0xff, 0x95, 0x58, 0xfe, 0xff, 0xff, 0x89, 0x85, 0x80, 0xf9, 0xff, 0xff, 0x8b, 0x95, 0x80, 0xf9, 0xff, 0xff, 0x89, 0x95, 0xdc, 0xf9, 0xff, 0xff, 0x83, 0xbd, 0xdc, 0xf9, 0xff, 0xff, 0x00, 0x0f,
	0x85, 0x64, 0x01, 0x00, 0x00, 0x6a, 0x40, 0x68, 0x00, 0x30, 0x00, 0x00, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x38, 0x51, 0x6a, 0x00, 0x8b, 0x95, 0xb8, 0xfc, 0xff, 0xff, 0x52, 0xff, 0x95, 0x58, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x14, 0xfe, 0xff, 0xff, 0x89, 0x45, 0xc8,
	0x8b, 0x45, 0xc8, 0x8b, 0x8d, 0x14, 0xfe, 0xff, 0xff, 0x03, 0x48, 0x3c, 0x89, 0x4d, 0xc4, 0x8b, 0x45, 0xc4, 0x83, 0xc0, 0x18, 0x89, 0x85, 0xd8, 0xf9, 0xff, 0xff, 0xb8, 0x08, 0x00, 0x00, 0x00, 0x6b, 0xc8, 0x05, 0x8b, 0x95, 0xd8, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0x14, 0xfe, 0xff,
	0xff, 0x03, 0x44, 0x0a, 0x60, 0x89, 0x85, 0xd4, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0xd4, 0xf9, 0xff, 0xff, 0x83, 0x78, 0x04, 0x00, 0x75, 0x0f, 0x8b, 0x85, 0xd4, 0xf9, 0xff, 0xff, 0x83, 0x38, 0x00, 0x0f, 0x84, 0xd8, 0x00, 0x00, 0x00, 0x8b, 0x85, 0xd4, 0xf9, 0xff, 0xff, 0x83, 0xc0,
	0x08, 0x89, 0x85, 0xd0, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0xd4, 0xf9, 0xff, 0xff, 0x8b, 0x48, 0x04, 0x83, 0xe9, 0x08, 0xd1, 0xe9, 0x89, 0x8d, 0xcc, 0xf9, 0xff, 0xff, 0xc7, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x0f, 0x8b, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x83,
	0xc0, 0x01, 0x89, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x3b, 0x85, 0xcc, 0xf9, 0xff, 0xff, 0x7d, 0x72, 0x8b, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0xd0, 0xf9, 0xff, 0xff, 0x0f, 0xbf, 0x14, 0x41, 0x81, 0xe2, 0xff, 0x0f, 0x00, 0x00, 0x8b, 0x85,
	0xd4, 0xf9, 0xff, 0xff, 0x03, 0x10, 0x89, 0x95, 0xc4, 0xf9, 0xff, 0xff, 0x8b, 0x85, 0xc8, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0xd0, 0xf9, 0xff, 0xff, 0x0f, 0xbf, 0x14, 0x41, 0x81, 0xe2, 0x00, 0xf0, 0x00, 0x00, 0xc1, 0xfa, 0x0c, 0x83, 0xfa, 0x03, 0x75, 0x2b, 0x8b, 0x85, 0xd8, 0xf9,
	0xff, 0xff, 0x8b, 0x8d, 0xdc, 0xf9, 0xff, 0xff, 0x2b, 0x48, 0x1c, 0x8b, 0x95, 0xc4, 0xf9, 0xff, 0xff, 0x03, 0x95, 0x14, 0xfe, 0xff, 0xff, 0x03, 0x0a, 0x8b, 0x85, 0xc4, 0xf9, 0xff, 0xff, 0x03, 0x85, 0x14, 0xfe, 0xff, 0xff, 0x89, 0x08, 0xe9, 0x71, 0xff, 0xff, 0xff, 0x8b, 0x85,
	0xd4, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0xd4, 0xf9, 0xff, 0xff, 0x03, 0x48, 0x04, 0x89, 0x8d, 0xd4, 0xf9, 0xff, 0xff, 0xe9, 0x0d, 0xff, 0xff, 0xff, 0x8b, 0x85, 0xd8, 0xf9, 0xff, 0xff, 0x8b, 0x8d, 0xdc, 0xf9, 0xff, 0xff, 0x89, 0x48, 0x1c, 0x6a, 0x00, 0x8b, 0x85, 0x1c, 0xfe, 0xff,
	0xff, 0x8b, 0x48, 0x38, 0x51, 0x8b, 0x95, 0x14, 0xfe, 0xff, 0xff, 0x52, 0x8b, 0x85, 0xdc, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0xb8, 0xfc, 0xff, 0xff, 0x51, 0xff, 0x95, 0x5c, 0xfe, 0xff, 0xff, 0x6a, 0x00, 0x6a, 0x04, 0x8d, 0x85, 0xdc, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0x90,
	0xfa, 0xff, 0xff, 0x83, 0xc1, 0x08, 0x51, 0x8b, 0x95, 0xb8, 0xfc, 0xff, 0xff, 0x52, 0xff, 0x95, 0x5c, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x1c, 0xfe, 0xff, 0xff, 0x8b, 0x48, 0x1c, 0x8b, 0x95, 0x1c, 0xfe, 0xff, 0xff, 0x03, 0x4a, 0x10, 0x89, 0x8d, 0x9c, 0xfa, 0xff, 0xff, 0x8d, 0x85,
	0xec, 0xf9, 0xff, 0xff, 0x50, 0x8b, 0x8d, 0xbc, 0xfc, 0xff, 0xff, 0x51, 0xff, 0x95, 0x54, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0xbc, 0xfc, 0xff, 0xff, 0x50, 0xff, 0x95, 0x50, 0xfe, 0xff, 0xff, 0x8b, 0x85, 0x14, 0xfe, 0xff, 0xff, 0x50, 0xff, 0x95, 0x30, 0xfe, 0xff, 0xff, 0x83, 0xc4,
	0x04, 0x6a, 0x00, 0xff, 0x95, 0x4c, 0xfe, 0xff, 0xff, 0xeb, 0x1b, 0x83, 0x7d, 0xe8, 0x00, 0x74, 0x09, 0x6a, 0x00, 0x8b, 0x45, 0xe8, 0x50, 0xff, 0x55, 0xe4, 0xb8, 0x8d, 0x40, 0x41, 0x00, 0xc3, 0xb8, 0x84, 0x40, 0x41, 0x00, 0xc3, 0xc7, 0x45, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xeb,
	0x07, 0xc7, 0x45, 0xfc, 0xff, 0xff, 0xff, 0xff, 0x8b, 0x4d, 0xf4, 0x64, 0x89, 0x0d, 0x00, 0x00, 0x00, 0x00, 0x5f, 0x5e, 0x5b, 0x8b, 0xe5, 0x5d, 0xc3, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc
};

int readFile(const char* filename, BYTE** buffer)
{
	FILE *fp = fopen(filename, "rb");
	if (fp == NULL)
	{
		//printf("无法打开EXE文件！");
		return NULL;
	}
	fseek(fp, 0, SEEK_END);
	int len = ftell(fp);
	fseek(fp, 0, SEEK_SET);
	*buffer = (BYTE*)malloc(len);
	if (*buffer == NULL)
	{
		//printf("分配空间失败");
		return NULL;
	}
	fread(*buffer, 1, len, fp);
	fclose(fp);
	return len;

}

void writeFile(const char* filename, BYTE* data, int len)
{
	FILE *fp = fopen(filename, "wb");
	if (fp == NULL)
	{
		//printf("无法打开EXE文件！");
		return;
	}
	fwrite(data, 1, len, fp);
	fclose(fp);
}

void writeFile(const char* filename, IN HPE pe)
{
	PE* p = (PE*)pe;
	FILE *fp = fopen(filename, "wb");
	if (fp == NULL)
	{
		//printf("无法打开EXE文件！");
		return;
	}
	fwrite(p->fileBuffer, 1, p->length, fp);
	fclose(fp);
}

int initializePE(const BYTE* data, IMAGE_DOS_HEADER** pDosHeader, IMAGE_NT_HEADERS** pNTHeaders, IMAGE_FILE_HEADER** pPEHeader, IMAGE_OPTIONAL_HEADER32** pOptionalHeader, IMAGE_SECTION_HEADER** pSectionHeader)
{
	
	if (*((PWORD)data) != IMAGE_DOS_SIGNATURE)
	{
		//printf("不是有效的MZ标志\n");
		return 0;
	}
	*pDosHeader = (IMAGE_DOS_HEADER*)data;
	/*printf("*************************DOS头******************************\n");
	printf("MZ标志：%08x\n", (*pDosHeader)->e_magic);
	printf("PE偏移：%08x\n\n", (*pDosHeader)->e_lfanew);*/
	if (*((PDWORD)((DWORD)data+(*pDosHeader)->e_lfanew)) != IMAGE_NT_SIGNATURE)
	{
		//printf("不是有效的PE标志\n");		
		return 0;
	}
	*pNTHeaders = (IMAGE_NT_HEADERS*)((DWORD)data+(*pDosHeader)->e_lfanew);
	/*printf("***************************NT头******************************\n");
	printf("NT: %08x\n", (*pNTHeaders)->Signature);*/
	*pPEHeader = (IMAGE_FILE_HEADER*)((DWORD)(*pNTHeaders)+4);
	/*printf("PE: %x\n", (*pPEHeader)->Machine);
	printf("节的数量：%08x\n", (*pPEHeader)->SizeOfOptionalHeader);*/

	*pOptionalHeader = (IMAGE_OPTIONAL_HEADER32*)((DWORD)(*pPEHeader)+IMAGE_SIZEOF_FILE_HEADER);
	/*printf("************************OPTION头**************************\n");
	printf("OPTION_PE: %08x\n\n", (*pOptionalHeader)->Magic);

	printf("************************节表**************************\n");*/
	*pSectionHeader = (IMAGE_SECTION_HEADER*)((DWORD)(*pOptionalHeader) + (*pPEHeader)->SizeOfOptionalHeader);
	/*IMAGE_SECTION_HEADER* p = *pSectionHeader;
	for (int i = 0; i < (*pPEHeader)->NumberOfSections; ++i)
	{
		char name[9] = {0};
		for (int j = 0; j < 9; ++j)
		{
			name[j] = p->Name[j];
		}
		printf("名称：%s\n", name);
		printf("在内存中大小(对齐前的长度)：%08x\n", p->Misc);
		printf("在内存中的偏移：%08x\n", p->VirtualAddress);
		printf("在文件中大小(对齐后的长度)：%08x\n", p->SizeOfRawData);
		printf("在文件中的偏移：%08x\n", p->PointerToRawData);
		printf("节的属性：%08x\n\n", p->Characteristics);
		p++;

	}*/
	return 1;
}

int fileBufferToImageBuffer(const BYTE* filebuffer, BYTE** imagebuffer)
{
	IMAGE_DOS_HEADER* pDosHeader = NULL;
	IMAGE_NT_HEADERS* pNTHeaders = NULL;
	IMAGE_FILE_HEADER* pPEHeader = NULL;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = NULL;
	IMAGE_SECTION_HEADER* pSectionHeader = NULL;
	initializePE(filebuffer, &pDosHeader, &pNTHeaders, &pPEHeader, &pOptionalHeader, &pSectionHeader);

	int length = pSectionHeader[pPEHeader->NumberOfSections - 1].VirtualAddress + pSectionHeader[pPEHeader->NumberOfSections - 1].SizeOfRawData;
	
	//有时候会出现length比Image还要大
	length = length > pOptionalHeader->SizeOfImage ? length : pOptionalHeader->SizeOfImage;
	
	BYTE* imageBuffer = (BYTE*)malloc(length);
	*imagebuffer = imageBuffer;
	memset(imageBuffer, 0, length);

	memcpy(imageBuffer, filebuffer, pOptionalHeader->SizeOfHeaders);
	
	for (int i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		memcpy(imageBuffer+pSectionHeader->VirtualAddress, filebuffer+pSectionHeader->PointerToRawData, pSectionHeader->SizeOfRawData);
		++pSectionHeader;
	}
	return pOptionalHeader->SizeOfImage;
}

int imageBufferToFileBuffer(const BYTE* imagebuffer, BYTE** filebuffer)
{
	IMAGE_DOS_HEADER* pDosHeader = NULL;
	IMAGE_NT_HEADERS* pNTHeaders = NULL;
	IMAGE_FILE_HEADER* pPEHeader = NULL;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = NULL;
	IMAGE_SECTION_HEADER* pSectionHeader = NULL;
	initializePE(imagebuffer, &pDosHeader, &pNTHeaders, &pPEHeader, &pOptionalHeader, &pSectionHeader);

	int len = (pSectionHeader[pPEHeader->NumberOfSections-1]).PointerToRawData+ (pSectionHeader[pPEHeader->NumberOfSections-1]).SizeOfRawData;
	*filebuffer = (BYTE*)malloc(len);
	BYTE* fileBuffer = *filebuffer;
	memset(fileBuffer, 0, len);

	memcpy(fileBuffer, imagebuffer, pOptionalHeader->SizeOfHeaders);

	for (int i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		memcpy(fileBuffer+pSectionHeader->PointerToRawData, imagebuffer+pSectionHeader->VirtualAddress, pSectionHeader->SizeOfRawData);
		++pSectionHeader;
	}

	return len;
}

IMAGE_SECTION_HEADER* getSectionHeader( IN HPE pe, IN int foa )
{
	PE* p = (PE*)pe;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;
	if (foa < pSectionHeader[0].PointerToRawData)
	{
		return NULL;
	}

	int i = 0;
	for (i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if (foa >= pSectionHeader[i].PointerToRawData)
		{
			continue;
		}
		break;
	}
	return  &pSectionHeader[i-1];
}

int RVA2FOA( IN HPE pe, IN int rva )
{
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;
	
	if (rva < pSectionHeader[0].VirtualAddress)
	{
		return rva;
	}
	
	int i = 0;
	for (i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if (rva >= pSectionHeader[i].VirtualAddress)
		{
			continue;
		}
		break;
	}
	return  rva - pSectionHeader[i-1].VirtualAddress + pSectionHeader[i-1].PointerToRawData;
}

int FOA2RVA( IN HPE pe, IN int foa )
{
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;

	if (foa < pSectionHeader[0].PointerToRawData)
	{
		return foa;
	}

	int i = 0;
	for (i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if (foa >= pSectionHeader[i].PointerToRawData)
		{
			continue;
		}
		break;
	}
	return  foa - pSectionHeader[i-1].PointerToRawData + pSectionHeader[i-1].VirtualAddress;
}

HPE loadPEFromBuffer(const BYTE* buffer, int length)
{
	PE* p = (PE*)malloc(sizeof(PE));
	memset(p, 0, sizeof(PE));
	p->length = length;
	p->fileBuffer = (BYTE*)buffer;

	if (!initializePE(buffer, &p->pDosHeader, &p->pNTHeaders, &p->pPEHeader, &p->pOptionalHeader, &p->pSectionHeader))
	{
		free(p);
		p = NULL;
	}
	return (HPE)p;
}
HPE loadPE(const char* filename)
{
	BYTE* fileBuffer = NULL;
	int len = readFile(filename, &fileBuffer);
	if (!fileBuffer)
	{
		return 0;
	}
	return loadPEFromBuffer(fileBuffer, len);
}
void releasePE(HPE pe)
{
	if (pe != 0)
	{
		PE* p = (PE*)pe;
		if (p->fileBuffer != NULL)
		{
			free(p->fileBuffer);
			p->fileBuffer = NULL;
		}	
		free(p);
	}
	
}

HPE addSection(IN HPE pe, IN const char* sectionName, IN int sectionLength, IN int properties)
{
	// 如果不遵守内存对齐的约定，系统将无法识别！！！
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;

	// 一定要注意内存对齐
	if (sectionLength % pOptionalHeader->SectionAlignment != 0)
	{
		sectionLength = (sectionLength / pOptionalHeader->SectionAlignment + 1) * pOptionalHeader->SectionAlignment;
	}
	
	pPEHeader->NumberOfSections += 1;
	pOptionalHeader->SizeOfImage += sectionLength;

	int index = pPEHeader->NumberOfSections - 1;

	strcpy((char*)pSectionHeader[index].Name, sectionName);
	pSectionHeader[index].Misc.VirtualSize = sectionLength;
	// 一定要注意内存对齐
	int offset = pSectionHeader[index-1].Misc.VirtualSize;
	if (offset % pOptionalHeader->SectionAlignment != 0)
	{
		offset = (offset / pOptionalHeader->SectionAlignment + 1) * pOptionalHeader->SectionAlignment;
	}
	pSectionHeader[index].VirtualAddress = pSectionHeader[index-1].VirtualAddress + offset;
	pSectionHeader[index].SizeOfRawData = sectionLength;
	// 一定要注意文件对齐
	offset = pSectionHeader[index-1].SizeOfRawData;
	if (offset % pOptionalHeader->FileAlignment != 0)
	{
		offset = (offset / pOptionalHeader->FileAlignment + 1) * pOptionalHeader->FileAlignment;
	}
	pSectionHeader[index].PointerToRawData = pSectionHeader[index-1].PointerToRawData + offset;
	pSectionHeader[index].Characteristics = properties;

	BYTE* newbuffer = (BYTE*)malloc(p->length + sectionLength);
	memset(newbuffer, 0, p->length + sectionLength);
	memcpy(newbuffer, p->fileBuffer, p->length);
	return loadPEFromBuffer(newbuffer, p->length + sectionLength);
}

void moveExportDirectory(IN HPE pe, IN const char* sectionName)
{
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;

	for (int i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if(!strcmp((char*)(pSectionHeader[i].Name), sectionName)){
			pSectionHeader = &pSectionHeader[i];
			break;
		}
	}


	IMAGE_EXPORT_DIRECTORY* pExportDirectory = (IMAGE_EXPORT_DIRECTORY*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress) + (int)p->fileBuffer);


	int* functionNames = (int*)(RVA2FOA(pe, pExportDirectory->AddressOfNames) + (int)p->fileBuffer);
	short* functionOrdinals = (short*)(RVA2FOA(pe, pExportDirectory->AddressOfNameOrdinals) + (int)p->fileBuffer);
	int* functionAddresses = (int*)(RVA2FOA(pe, pExportDirectory->AddressOfFunctions) + (int)p->fileBuffer);


	// 复制AddressOfFunctions
	memcpy((BYTE*)(pSectionHeader->PointerToRawData+(int)p->fileBuffer), (BYTE*)functionAddresses, (pExportDirectory->NumberOfFunctions) * 4);
	
	// 复制AddressOfOrdinals
	int ordinalsOffset = (pExportDirectory->NumberOfFunctions) * 4;
	memcpy((BYTE*)(pSectionHeader->PointerToRawData + ordinalsOffset+(int)p->fileBuffer), (BYTE*)functionOrdinals, (pExportDirectory->NumberOfNames) * 2);
	
	// 复制所有函数名
	int namesAddressOffset = ordinalsOffset + (pExportDirectory->NumberOfNames) * 2;
	memcpy((BYTE*)(pSectionHeader->PointerToRawData + namesAddressOffset+(int)p->fileBuffer), (BYTE*)functionNames, (pExportDirectory->NumberOfNames) * 4);

	int namesOffset = namesAddressOffset + (pExportDirectory->NumberOfNames) * 4;
	for (int i = 0; i < pExportDirectory->NumberOfNames; ++i)
	{
		strcpy((char*)(pSectionHeader->PointerToRawData + namesOffset+(int)p->fileBuffer), (char*)(RVA2FOA(pe, functionNames[i]))+(int)p->fileBuffer);
		*(int*)(pSectionHeader->PointerToRawData + namesAddressOffset + 4 * i+(int)p->fileBuffer) = FOA2RVA(pe, pSectionHeader->PointerToRawData + namesOffset);
		namesOffset = namesOffset + strlen((char*)(RVA2FOA(pe, functionNames[i]))+(int)p->fileBuffer) + 1;
	}

	// 复制 IMAGE_EXPORT_DIRECTORY 结构
	int filenameOffset = namesOffset;
	strcpy((char*)(pSectionHeader->PointerToRawData + filenameOffset+(int)p->fileBuffer), (char*)(RVA2FOA(pe, pExportDirectory->Name) + (int)p->fileBuffer));
	int exportDirectoryOffset = filenameOffset + strlen((char*)(pSectionHeader->PointerToRawData + filenameOffset+(int)p->fileBuffer)) + 1;
	memcpy((BYTE*)(pSectionHeader->PointerToRawData + exportDirectoryOffset+(int)p->fileBuffer), (BYTE*)pExportDirectory, sizeof(IMAGE_EXPORT_DIRECTORY));
	

	// 修复 IMAGE_EXPORT_DIRECTORY 结构
	IMAGE_EXPORT_DIRECTORY* pNewExportDirectory = (IMAGE_EXPORT_DIRECTORY*)(pSectionHeader->PointerToRawData + exportDirectoryOffset+(int)p->fileBuffer);
	pNewExportDirectory->AddressOfFunctions = FOA2RVA(pe, pSectionHeader->PointerToRawData);
	pNewExportDirectory->AddressOfNameOrdinals = FOA2RVA(pe, pSectionHeader->PointerToRawData + ordinalsOffset);
	pNewExportDirectory->AddressOfNames = FOA2RVA(pe, pSectionHeader->PointerToRawData + namesAddressOffset);
	pNewExportDirectory->Name = FOA2RVA(pe, pSectionHeader->PointerToRawData + filenameOffset);
	// 修复目录项
	pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress = FOA2RVA(pe, pSectionHeader->PointerToRawData + exportDirectoryOffset);
}

void moveRelocationDirectory(IN HPE pe, IN const char* sectionName)
{
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;

	for (int i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if(!strcmp((char*)(pSectionHeader[i].Name), sectionName)){
			pSectionHeader = &pSectionHeader[i];
			break;
		}
	}

	IMAGE_BASE_RELOCATION* pBaseRelocation = (IMAGE_BASE_RELOCATION*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress) + (int)p->fileBuffer);
	IMAGE_BASE_RELOCATION* pBaseRelocationBak = pBaseRelocation;
	int size = 0;
	while ((pBaseRelocation->VirtualAddress | pBaseRelocation->SizeOfBlock) != 0)
	{
		size += pBaseRelocation->SizeOfBlock;
		pBaseRelocation = (IMAGE_BASE_RELOCATION*)((int)pBaseRelocation + pBaseRelocation->SizeOfBlock);
	}
	memcpy((BYTE*)(pSectionHeader->PointerToRawData+(int)p->fileBuffer), (BYTE*)pBaseRelocationBak, size);

	pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress = FOA2RVA(pe, pSectionHeader->PointerToRawData);
}

void modifyRelocationDirectory( IN HPE pe, IN int imageBase )
{
	PE* p = (PE*)pe;
	IMAGE_DOS_HEADER* pDosHeader = p->pDosHeader;
	IMAGE_NT_HEADERS* pNTHeaders = p->pNTHeaders;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;


	IMAGE_BASE_RELOCATION* pBaseRelocation = (IMAGE_BASE_RELOCATION*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress) + (int)p->fileBuffer);
	while ((pBaseRelocation->VirtualAddress | pBaseRelocation->SizeOfBlock) != 0)
	{
		short* pTable = (short*)((int)pBaseRelocation + 8);
		int len = (pBaseRelocation->SizeOfBlock - 8) / 2;
		for (int i = 0; i < len; ++i)
		{
			int RVA = pBaseRelocation->VirtualAddress + (pTable[i] & 0x0FFF);
			int FOA = RVA2FOA(pe, RVA);
			if (((pTable[i] & 0xF000) >> 12) == 3)
			{
				*(int*)(FOA+ (int)p->fileBuffer) += (imageBase - pOptionalHeader->ImageBase);
			}
		}
		pBaseRelocation = (IMAGE_BASE_RELOCATION*)((int)pBaseRelocation + pBaseRelocation->SizeOfBlock);
	}
	pOptionalHeader->ImageBase = imageBase;
}

IMAGE_IMPORT_DESCRIPTOR* getImportDescriptor( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	return (IMAGE_IMPORT_DESCRIPTOR*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress) + (int)p->fileBuffer);
}

BYTE* getFileBuffer( IN HPE pe )
{
	PE* p = (PE*)pe;
	return p->fileBuffer;
}

int getFileLength(IN HPE pe)
{
	PE* p = (PE*)pe;
	return p->length;
}

IMAGE_BOUND_IMPORT_DESCRIPTOR* getBoundImportDescriptor( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	if (pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT].VirtualAddress == 0)
	{
		return NULL;
	}
	return (IMAGE_BOUND_IMPORT_DESCRIPTOR*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT].VirtualAddress) + (int)p->fileBuffer);
}
IMAGE_RESOURCE_DIRECTORY* getResourceDirectory( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	if (pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].VirtualAddress == 0)
	{
		return NULL;
	}
	return (IMAGE_RESOURCE_DIRECTORY*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].VirtualAddress) + (int)p->fileBuffer);
}
IMAGE_SECTION_HEADER* getSection(IN HPE pe, IN const char* sectionName)
{
	PE* p = (PE*)pe;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;

	for (int i = 0; i < pPEHeader->NumberOfSections; ++i)
	{
		if(!strcmp((char*)(pSectionHeader[i].Name), sectionName)){
			pSectionHeader = &pSectionHeader[i];
			return pSectionHeader;
		}
	}
	return NULL;
}

IMAGE_SECTION_HEADER* getLastSection(IN HPE pe)
{
	PE* p = (PE*)pe;
	IMAGE_FILE_HEADER* pPEHeader = p->pPEHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = p->pSectionHeader;
	return pSectionHeader + (pPEHeader->NumberOfSections - 1);
}

IMAGE_IMPORT_DESCRIPTOR* moveImportDescriptor(IN HPE pe, IN const char* sectionName)
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	IMAGE_SECTION_HEADER* pSectionHeader = getSection(pe, sectionName);
	
	IMAGE_IMPORT_DESCRIPTOR* pImportDescriptor = getImportDescriptor(pe);
	IMAGE_IMPORT_DESCRIPTOR* dst = (IMAGE_IMPORT_DESCRIPTOR*)(pSectionHeader->PointerToRawData + (int)p->fileBuffer);
	IMAGE_IMPORT_DESCRIPTOR* pNewImportDescriptor = dst;
	int size = 0;
	while ((pImportDescriptor->OriginalFirstThunk | pImportDescriptor->TimeDateStamp | pImportDescriptor->ForwarderChain | pImportDescriptor->Name | pImportDescriptor->FirstThunk ) != 0)
	{
		memcpy(dst, pImportDescriptor, sizeof(IMAGE_IMPORT_DESCRIPTOR));
		++dst;
		++pImportDescriptor;
		size += sizeof(IMAGE_IMPORT_DESCRIPTOR);
	}
	
	if (size % pOptionalHeader->FileAlignment != 0)
	{
		size = (size / pOptionalHeader->FileAlignment + 1) * pOptionalHeader->FileAlignment;
	}
	//修复目录项
	pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress = pSectionHeader->VirtualAddress;
	pSectionHeader->SizeOfRawData = size;
	return pNewImportDescriptor;
}

void importDescriptorInject(IN HPE pe, IN IMAGE_IMPORT_DESCRIPTOR* pImportDescriptor, IN const char* moduleName, IN const char** functionNames, IN int length)
{
	BYTE* filebuffer = getFileBuffer(pe);
	IMAGE_IMPORT_DESCRIPTOR* pImportDescriptorBase = pImportDescriptor;
	IMAGE_SECTION_HEADER* pSectionHeader = getSectionHeader(pe, (int)pImportDescriptor - (int)filebuffer);

	int size = 0;
	while ((pImportDescriptor->OriginalFirstThunk | pImportDescriptor->TimeDateStamp | pImportDescriptor->ForwarderChain | pImportDescriptor->Name | pImportDescriptor->FirstThunk ) != 0)
	{
		++pImportDescriptor;
		size += sizeof(IMAGE_IMPORT_DESCRIPTOR);
	}

	int* originalFirstThunk = (int*)((int)pImportDescriptorBase + size + 0x200);
	int* FirstThunk = (int*)((int)pImportDescriptorBase + size + 0x400);
	char* newFunctionNames = (char*)((int)pImportDescriptorBase + size + 0x600);
	char* name = (char*)((int)pImportDescriptorBase + size + 0x900);

	pImportDescriptor->OriginalFirstThunk = FOA2RVA(pe, (int)originalFirstThunk - (int)filebuffer);
	pImportDescriptor->FirstThunk = FOA2RVA(pe, (int)FirstThunk - (int)filebuffer);
	pImportDescriptor->Name = FOA2RVA(pe, (int)name - (int)filebuffer);
	pImportDescriptor->TimeDateStamp = 0;

	strcpy(name, moduleName);
	for (int i = 0; i < length; ++i)
	{
		*originalFirstThunk++ = FOA2RVA(pe, (int)newFunctionNames - (int)filebuffer);
		*FirstThunk++ = FOA2RVA(pe, (int)newFunctionNames - (int)filebuffer);

		
		strcpy(newFunctionNames + 2, functionNames[i]);
		newFunctionNames += strlen(functionNames[i]) + 3;
	}
}

void getString(const IMAGE_RESOURCE_DIR_STRING_U* str, WCHAR* buffer, int length)
{
	int i = 0;
	for ( i = 0; i < str->Length && i < length - 1; ++i)
	{
		buffer[i] = str->NameString[i];
	}
	buffer[i] = 0;
}

IMAGE_OPTIONAL_HEADER32* getOptionalHeader( IN HPE pe )
{
	PE* p = (PE*)pe;
	return p->pOptionalHeader;
}

IMAGE_FILE_HEADER* getFileHeader( IN HPE pe )
{
	PE* p = (PE*)pe;
	return p->pPEHeader;
}

IMAGE_SECTION_HEADER* getSectionBase( IN HPE pe )
{
	PE* p = (PE*)pe;
	return p->pSectionHeader;
}

IMAGE_EXPORT_DIRECTORY* getExportDirectory( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	if (pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress == 0)
	{
		return NULL;
	}
	IMAGE_EXPORT_DIRECTORY* pExportDirectory = (IMAGE_EXPORT_DIRECTORY*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress) + (int)p->fileBuffer);
	return pExportDirectory;
}

IMAGE_BASE_RELOCATION* getRelocationDirectory( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	if (pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress == 0)
	{
		return NULL;
	}
	IMAGE_BASE_RELOCATION* pRelocationDirectory = (IMAGE_BASE_RELOCATION*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress) + (int)p->fileBuffer);
	return pRelocationDirectory;
}

int* getIATDirectory( IN HPE pe )
{
	PE* p = (PE*)pe;
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = p->pOptionalHeader;
	if (pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_IAT].VirtualAddress == 0)
	{
		return NULL;
	}
	int* pIAT = (int*)(RVA2FOA(pe, pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_IAT].VirtualAddress) + (int)p->fileBuffer);
	return pIAT;
}


HPE protect(IN HPE shell, IN HPE object)
{

	int length = getFileLength(object);
	BYTE* src = getFileBuffer(object);
	HPE newObj = addSection(shell, ".src", length + 0x2000, 0x60000020);
	IMAGE_OPTIONAL_HEADER32* pOptionalHeader = getOptionalHeader(newObj);
	IMAGE_SECTION_HEADER* pShellSection = getLastSection(newObj);
	pOptionalHeader->AddressOfEntryPoint = pShellSection->VirtualAddress;
	memcpy((void*)(pShellSection->PointerToRawData + (int)getFileBuffer(newObj)), shellcode, sizeof(shellcode));
	memcpy((void*)(pShellSection->PointerToRawData + (int)getFileBuffer(newObj) + 0x2000), src, length);
	return newObj;
}






